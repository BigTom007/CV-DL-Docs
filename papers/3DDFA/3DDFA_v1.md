# Face Alignment in Full Pose Range: A 3D Total Solution

人脸对齐，是将一张（人脸）图片与一个人脸模型对齐并提取人脸像素的语义信息，已经称为CV领域的一个重要方向。但是大多数算法是针对中小姿态（偏航角小于45°）人脸设计的，无法对齐到90°的大姿态角人脸。有三个挑战，第一，常用的关键点人脸模型假设所有关键点都可见，因此不适用于大姿态情况；第二，从正脸到侧脸，大姿态变化下人脸的外观变化很剧烈；第三，因为不可见关键点需要猜测其位置，所以大姿态关键点定位很困难。本文提出一个新对齐框架来解决这三个挑战，称为3D Dense Face Alignment(3DDFA)，其中通过级联卷积神经网络将一个稠密3D可变形模型(3D Morphable Model, 3DMM)拟合到图片中。还通过使用3D信息来生成侧脸图片以保证训练样本数量充足。



## Introduction

人脸对齐是一个通过移动和变形将一个人脸模型放到图片中的过程，以便于提取人脸像素的语义信息。一般来说，人脸对齐是通过关键点检测来实现的，定位一组离散的面部基准点。但是大多数现有方法都是针对中等姿态，假设偏航角小于45°且所有关键点可见。当偏航角范围扩大到90°时就变出现巨大的挑战，这些挑战主要可以分成三类：

* **Modelling：**关键点形状模型假设每个关键点都可以通过其独特的视觉模式健壮地检测到。但是非正脸的情况下，有一些关键点由于自遮挡的原因而变得不可见。中等姿态下这个问题可以通过将轮廓上的关键点移动到阴影中来解决，称为landmark marching.但是大姿态情况下，半张脸都被遮挡住了，有些关键点完全不可见且无法检测。反过来，关键点可能丢失语义信息，导致模型失效。
* **Fitting：**另一个全姿态人脸对齐的挑战是由从正脸到侧脸夸张的外观差异而导致的。级联线性回归和传统非线性模型无法以统一的方式适应这些复杂的差异。
* **Training Data：**带标注的数据时所有监督学习算法的基础。但是手工标注大姿态人脸很麻烦，因为被遮挡的关键点位置得靠猜，对于大多数人来说几乎做不到。以至于几乎所有人脸对齐的公共数据集（如AFW，LFPW，HELEN，IBUG等）都只包含中等姿态。少数大姿态数据集（如AFLW）只包含可见关键点，不可见点不明确，难以训练一个统一的人脸对齐模型

本文要解决全姿态范围的人脸对齐问题，偏航角可在±90°范围内变化。我们相信人脸对齐并不仅仅是一个2D问题，因为自遮挡和大外观差异是由3D空间内人脸旋转导致的，结合3D信息就可以解决这个问题。具体来说，我们将人脸模型从2D离散关键点升级到稠密3D可变形模型(3DMM)并将人脸对齐任务视为一个3DMM匹配任务。优化概念就从关键点位置变成姿态（尺度，旋转和平移）和形变（形状和表情）参数。我们称这个新的人脸对齐框架为3D Dense Face Alignment(3DDFA).



## Related Works

人脸对齐可以总结成将一个人脸模型与图像相匹配。因此也就有两个基本问题：如何将脸部形状建模和如何估计模型的参数。

### Face Model

传统的人脸形状表示时使用一组离散的2D基准点集合。形状变化可由子空间分析（如PCA）进行建模。但是这个2D子空间模型只能应对小范围姿态变化，因为非线性平面外旋转无法在线性空间内很好的表示。为了解决姿态变化问题，提出了一些改进（如Kernel PCA和Bayesian Mixture Model）来在子空间模型中引入非线性元素。Blanz et al.提出3D形变模型（3DMM），在一组3D扫描人脸上使用PCA。通过结合3D信息，3DMM将非线性平面外变换与PCA子空间解耦。剩下的形状和表情变化表现出高度线性特性，可以通过PCA建模。与2D模型相比，3DMM将刚性（姿态）和非刚性（形状和表情）变换分离开，使其可以覆盖各种形状差异并同时保持形状先验。另外3DMM可以轻松估计点的可见性，提供解决侧脸自遮挡的重要线索。

### Model Fitting

